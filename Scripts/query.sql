CREATE VIEW instrucoes_por_contrato AS 
SELECT *
FROM (
    SELECT cho.id_contract, o.name AS opcode, cho.Qntd
    FROM main.contracts_have_opcodes cho
    JOIN main.opcodes o ON o.id = cho.id_opcodes
    ORDER BY cho.id_contract
)
PIVOT (
    SUM(Qntd) FOR opcode IN (
        'ADD', 'ADDMOD', 'ADDRESS', 'AND' AS AND_ , 'BALANCE', 'BASEFEE', 'BLOCKHASH', 'BYTE', 'CALL' AS CALL_, 'CALLCODE',
		'CALLDATACOPY', 'CALLDATALOAD', 'CALLDATASIZE', 'CHAINID', 'CODECOPY', 'CODESIZE', 'COINBASE', 'CREATE' AS CREATE_,
		'CREATE2', 'DELEGATECALL', 'DIFFICULTY', 'DIV', 'DUP1', 'DUP10', 'DUP11', 'DUP12', 'DUP13', 'DUP14',
		'DUP15', 'DUP16', 'DUP2', 'DUP3', 'DUP4', 'DUP5', 'DUP6', 'DUP7', 'DUP8', 'DUP9', 'EQ', 'EXP' AS EXP_,
		'EXTCODECOPY', 'EXTCODEHASH', 'EXTCODESIZE', 'GAS', 'GASLIMIT', 'GASPRICE', 'GT', 'INVALID', 'ISZERO',
		'JUMP', 'JUMPI', 'JUMPDEST', 'LOG0', 'LOG1', 'LOG2', 'LOG3', 'LOG4', 'LT', 'MLOAD', 'MOD' AS MOD_, 'MSTORE',
		'MSTORE8', 'MSIZE', 'MUL', 'MULMOD', 'NOT' AS NOT_, 'NUMBER' AS NUMBER_, 'OR' AS OR_, 'ORIGIN', 'PC', 'POP', 'PUSH1', 'PUSH10',
		'PUSH11', 'PUSH12', 'PUSH13', 'PUSH14', 'PUSH15', 'PUSH16', 'PUSH17', 'PUSH18', 'PUSH19', 'PUSH2',
		'PUSH20', 'PUSH21', 'PUSH22', 'PUSH23', 'PUSH24', 'PUSH25', 'PUSH26', 'PUSH27', 'PUSH28', 'PUSH29',
		'PUSH3', 'PUSH30', 'PUSH31', 'PUSH32', 'PUSH4', 'PUSH5', 'PUSH6', 'PUSH7', 'PUSH8', 'PUSH9', 'RETURN' AS RETURN_,
		'REVERT', 'SLOAD', 'SSTORE', 'SELFBALANCE', 'SELFDESTRUCT', 'SHA3', 'SHL', 'SHR', 'SIGNEXTEND',
		'SIZE' AS SIZE_, 'SDIV', 'SGT', 'SLT', 'SMOD', 'STATICCALL', 'STOP', 'SUB', 'SWAP1', 'SWAP10', 'SWAP11',
		'SWAP12', 'SWAP13', 'SWAP14', 'SWAP15', 'SWAP16', 'SWAP2', 'SWAP3', 'SWAP4', 'SWAP5', 'SWAP6',
		'SWAP7', 'SWAP8', 'SWAP9', 'TIMESTAMP' AS TIMESTAMP_, 'XOR' AS XOR_
    )
);
SELECT SUM(ADD), sum(AND_) from instrucoes_por_contrato;
COPY(SELECT 
    SUM(ADD) AS ADD,
    SUM(ADDMOD) AS ADDMOD,
    SUM(ADDRESS) AS ADDRESS,
    SUM(AND_) AS AND_,
    SUM(BALANCE) AS BALANCE,
    SUM(BASEFEE) AS BASEFEE,
    SUM(BLOCKHASH) AS BLOCKHASH,
    SUM(BYTE) AS BYTE,
    SUM(CALL_) AS CALL_,
    SUM(CALLCODE) AS CALLCODE,
    SUM(CALLDATACOPY) AS CALLDATACOPY,
    SUM(CALLDATALOAD) AS CALLDATALOAD,
    SUM(CALLDATASIZE) AS CALLDATASIZE,
    SUM(CHAINID) AS CHAINID,
    SUM(CODECOPY) AS CODECOPY,
    SUM(CODESIZE) AS CODESIZE,
    SUM(COINBASE) AS COINBASE,
    SUM(CREATE_) AS CREATE_,
    SUM(CREATE2) AS CREATE2,
    SUM(DELEGATECALL) AS DELEGATECALL,
    SUM(DIFFICULTY) AS DIFFICULTY,
    SUM(DIV) AS DIV_,
    SUM(DUP1) AS DUP1,
    SUM(DUP10) AS DUP10,
    SUM(DUP11) AS DUP11,
    SUM(DUP12) AS DUP12,
    SUM(DUP13) AS DUP13,
    SUM(DUP14) AS DUP14,
    SUM(DUP15) AS DUP15,
    SUM(DUP16) AS DUP16,
    SUM(DUP2) AS DUP2,
    SUM(DUP3) AS DUP3,
    SUM(DUP4) AS DUP4,
    SUM(DUP5) AS DUP5,
    SUM(DUP6) AS DUP6,
    SUM(DUP7) AS DUP7,
    SUM(DUP8) AS DUP8,
    SUM(DUP9) AS DUP9,
    SUM(EQ) AS EQ,
    SUM(EXP_) AS EXP_,
    SUM(EXTCODECOPY) AS EXTCODECOPY,
    SUM(EXTCODEHASH) AS EXTCODEHASH,
    SUM(EXTCODESIZE) AS EXTCODESIZE,
    SUM(GAS) AS GAS,
    SUM(GASLIMIT) AS GASLIMIT,
    SUM(GASPRICE) AS GASPRICE,
    SUM(GT) AS GT,
    SUM(INVALID) AS INVALID,
    SUM(ISZERO) AS ISZERO,
    SUM(JUMP) AS JUMP,
    SUM(JUMPI) AS JUMPI,
    SUM(JUMPDEST) AS JUMPDEST,
    SUM(LOG0) AS LOG0,
    SUM(LOG1) AS LOG1,
    SUM(LOG2) AS LOG2,
    SUM(LOG3) AS LOG3,
    SUM(LOG4) AS LOG4,
    SUM(LT) AS LT,
    SUM(MLOAD) AS MLOAD,
    SUM(MOD_) AS MOD_,
    SUM(MSTORE) AS MSTORE,
    SUM(MSTORE8) AS MSTORE8,
    SUM(MSIZE) AS MSIZE,
    SUM(MUL) AS MUL,
    SUM(MULMOD) AS MULMOD,
    SUM(NOT_) AS NOT_,
    SUM(NUMBER_) AS NUMBER_,
    SUM(OR_) AS OR_,
    SUM(ORIGIN) AS ORIGIN,
    SUM(PC) AS PC,
    SUM(POP) AS POP,
    SUM(PUSH1) AS PUSH1,
    SUM(PUSH10) AS PUSH10,
    SUM(PUSH11) AS PUSH11,
    SUM(PUSH12) AS PUSH12,
    SUM(PUSH13) AS PUSH13,
    SUM(PUSH14) AS PUSH14,
    SUM(PUSH15) AS PUSH15,
    SUM(PUSH16) AS PUSH16,
    SUM(PUSH17) AS PUSH17,
    SUM(PUSH18) AS PUSH18,
    SUM(PUSH19) AS PUSH19,
    SUM(PUSH2) AS PUSH2,
    SUM(PUSH20) AS PUSH20,
    SUM(PUSH21) AS PUSH21,
    SUM(PUSH22) AS PUSH22,
    SUM(PUSH23) AS PUSH23,
    SUM(PUSH24) AS PUSH24,
    SUM(PUSH25) AS PUSH25,
    SUM(PUSH26) AS PUSH26,
    SUM(PUSH27) AS PUSH27,
    SUM(PUSH28) AS PUSH28,
    SUM(PUSH29) AS PUSH29,
    SUM(PUSH3) AS PUSH3,
    SUM(PUSH30) AS PUSH30,
    SUM(PUSH31) AS PUSH31,
    SUM(PUSH32) AS PUSH32,
    SUM(PUSH4) AS PUSH4,
    SUM(PUSH5) AS PUSH5,
    SUM(PUSH6) AS PUSH6,
    SUM(PUSH7) AS PUSH7,
    SUM(PUSH8) AS PUSH8,
    SUM(PUSH9) AS PUSH9,
    SUM(RETURN_) AS RETURN_,
    SUM(REVERT) AS REVERT,
    SUM(SLOAD) AS SLOAD,
    SUM(SSTORE) AS SSTORE,
    SUM(SELFBALANCE) AS SELFBALANCE,
    SUM(SELFDESTRUCT) AS SELFDESTRUCT,
    SUM(SHA3) AS SHA3,
    SUM(SHL) AS SHL,
    SUM(SHR) AS SHR,
    SUM(SIGNEXTEND) AS SIGNEXTEND,
    SUM(SIZE_) AS SIZE_,
    SUM(SDIV) AS SDIV,
    SUM(SGT) AS SGT,
    SUM(SLT) AS SLT,
    SUM(SMOD) AS SMOD,
    SUM(STATICCALL) AS STATICCALL,
    SUM(STOP) AS STOP,
    SUM(SUB) AS SUB,
    SUM(SWAP1) AS SWAP1,
    SUM(SWAP10) AS SWAP10,
    SUM(SWAP11) AS SWAP11,
    SUM(SWAP12) AS SWAP12,
    SUM(SWAP13) AS SWAP13,
    SUM(SWAP14) AS SWAP14,
    SUM(SWAP15) AS SWAP15,
    SUM(SWAP16) AS SWAP16,
    SUM(SWAP2) AS SWAP2,
    SUM(SWAP3) AS SWAP3,
    SUM(SWAP4) AS SWAP4,
    SUM(SWAP5) AS SWAP5,
    SUM(SWAP6) AS SWAP6,
    SUM(SWAP7) AS SWAP7,
    SUM(SWAP8) AS SWAP8,
    SUM(SWAP9) AS SWAP9,
    SUM(TIMESTAMP_) AS TIMESTAMP_,
    SUM(XOR_) AS XOR_
FROM instrucoes_por_contrato) TO 'query.csv' (HEADER, DELIMITER ',');	





